<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Building Apps around the Event Mesh :: Solution Patterns for Cloud Native Architectures</title>
    <link rel="canonical" href="https://redhat-solution-patterns.github.io/solution-patterns/solution-pattern-event-mesh-for-microservices/02-architecture.html">
    <link rel="prev" href="index.html">
    <link rel="next" href="03-demo.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" style="font-size: 20px; color: white"
        href="https://redhat-solution-patterns.github.io/solution-patterns">
        <img src="../_/img/logo.png" height="35px" alt="Solution Patterns">&nbsp; Solution Patterns for Cloud Native Architectures</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Architectures &amp; Patterns</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://www.redhat.com/architect/portfolio/" target="_blank">Portfolio Architecture&nbsp; </a>
            <a class="navbar-item" href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html"  target="_blank">Solution Patterns </a>
            <a class="navbar-item" href="https://validatedpatterns.io/" target="_blank">Validated Patterns&nbsp;</a>
            <a class="navbar-item" href="https://catalog.redhat.com/solutions" target="_blank">Ecosystem Solutions&nbsp;</a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" target="_blank" href="https://developers.redhat.com">Red Hat Developers</a>
            <a class="navbar-item" target="_blank" href="https://developers.redhat.com/app-dev-platform">App Dev Platform</a>
            <a class="navbar-item" target="_blank" href="https://www.redhat.com/en/products/application-foundations">Red Hat Application Services</a>
          </div>
        </div>

          <a class="navbar-item" target="_blank" href="https://github.com/redhat-solution-patterns/redhat-solution-patterns.github.io/issues">Feedback</a>
          <a class="navbar-item" target="_blank" href="https://redhat-solution-patterns.github.io/solution-patterns/contributors-guide.html">Contribute</a>

      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="solution-pattern-event-mesh-for-microservices" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Event Mesh For Applications</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">1. Home page</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#use-cases">1.1 Use cases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_the_story_behind_this_solution_pattern">1.2 The story behind this solution pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#_the_solution">1.3 The solution</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-architecture.html">2. Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#tech_stack">2.1. Technology stack</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#in_depth">2.2. An in-depth look at the solution&#8217;s architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#more_tech">2.3. More about the technology stack</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html">3. See the Solution in Action</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-demo.html#_demonstration">3.1. Demonstration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html#_run_the_demonstration">3.2. Run this demonstration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_before_getting_started">3.3. Pre-requisites</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_installing_the_demo">3.4. Installing the demo</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03-demo.html#_walkthrough_guide">3.5. Walkthrough guide</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-workshop.html">4. Workshop</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-workshop.html#_installing_the_workshop_environment">4.1. Installing the workshop environment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-workshop.html#_before_getting_started">4.2. Pre-requisites</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-workshop.html#_installing_the_environment">4.3. Installing the environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-workshop.html#deliver_wksp">4.4. Delivering the workshop</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="developer-resources.html">5. Developer Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html" target="_blank" rel="noopener">Explore Red Hat Solution Patterns</a></span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Event Mesh For Applications</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Event Mesh For Applications</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Event Mesh For Applications</a></li>
    <li><a href="02-architecture.html">2. Architecture</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/cardil/solution-pattern-event-mesh-for-microservices/edit/HEAD/documentation/modules/ROOT/pages/02-architecture.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Building Apps around the Event Mesh</h1>
<h1 id="_architecture" class="sect0"><a class="anchor" href="#_architecture"></a><a class="link" href="#_architecture">Architecture</a></h1>
<div class="openblock partintro">
<div class="content">
<div class="paragraph">
<p>The architecture of an event mesh-enabled system is a paradigm shift from
traditional transactional designs to an eventual consistency model. This design
aligns better with real-world processes, where different parts of a system may
operate asynchronously yet collaboratively. In this section, we explore the
technologies, flow, and structure that make the event mesh architecture
resilient, scalable, and developer-friendly.</p>
</div>
<div class="paragraph">
<p>The solution employs <em>Command Query Responsibility Segregation (CQRS)</em> to
separate commands and queries. Commands are modeled as asynchronous events and
handled by the event mesh. Queries are synchronous operations safe to retry.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tech_stack"><a class="anchor" href="#tech_stack"></a><a class="link" href="#tech_stack">1. Technology Stack</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here&#8217;s the list of technologies used in this solution and its examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Red Hat supported products</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.redhat.com/en/technologies/cloud-computing/openshift">Red Hat OpenShift</a>
&mdash; Orchestrate containerized applications. Based on <a href="https://kubernetes.io/">Kuberentes</a>.</p>
</li>
<li>
<p><a href="https://www.redhat.com/en/technologies/cloud-computing/openshift/serverless">Red Hat OpenShift Serverless</a>
&mdash; Provides the <em>Event Mesh</em> and <em>Serverless</em> capabilities. Based on <a href="https://knative.dev">Knative</a>.</p>
</li>
<li>
<p><a href="https://swc.saas.ibm.com/en-us/redhat-marketplace/products/red-hat-amq">Red Hat AMQ Streams</a>
&mdash; (Optional) Provides a persistence for <em>Event Mesh</em>, likely needed in production. Based on <a href="https://strimzi.io/">Strimzi</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Other open source technologies:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://cloudevents.io/">CloudEvents</a> &mdash; Provides a standard for event metadata</p>
</li>
<li>
<p>Rust and <a href="https://access.redhat.com/products/quarkus">Quarkus</a> &mdash; Implementation examples.</p>
</li>
<li>
<p><a href="https://opentelemetry.io/">OpenTelemetry</a> &mdash; (Optional) Facilitates tracing for observability.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="in_depth"><a class="anchor" href="#in_depth"></a><a class="link" href="#in_depth">2. An in-depth look at the solution&#8217;s architecture</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Building applications around the Event Mesh is a solution that can be applied
either to existing applications or to greenfield projects. The existing
applications can be divided by their domain boundaries. The divided parts might
become modules, or even external services. Those modules will issue commands,
directed towards the Event Mesh, which will be routed towards the configured
endpoints.</p>
</div>
<div class="sect2">
<h3 id="_problem_analysis"><a class="anchor" href="#_problem_analysis"></a><a class="link" href="#_problem_analysis">2.1. Problem Analysis</a></h3>
<div class="paragraph">
<p>Traditional transactional systems enforce strict consistency, which slows
applications and distorts business logic. In our illustrative Cabs app example,
we must accommodate real-world scenarios, such as exiting a cab, even when
dependent systems (e.g., invoicing) encounter disruptions. Disregarding errors,
which preserve the integrity of existing data, discards the newly generated data
from genuine events. This results in a negative user experience and distorts
the actual business process, leading to potential customer dissatisfaction.</p>
</div>
</div>
<div class="sect2">
<h3 id="_solution_breakdown"><a class="anchor" href="#_solution_breakdown"></a><a class="link" href="#_solution_breakdown">2.2. Solution Breakdown</a></h3>
<div class="paragraph">
<p>The concept of employing the Event Mesh as a central, reliable hub for dispatching
commands, as events, lies at the heart of this solution. This approach aligns
closely with the Command Query Responsibility Segregation (CQRS) pattern, which
distinctly categorizes commands and queries. Commands, in this context, are
modeled as asynchronous events, designed to undergo processing by the event mesh.
On the other hand, queries are synchronous operations, safe to retry, ensuring
no loss of data integrity due to transient errors.</p>
</div>
<div class="paragraph">
<p>The primary responsibility of the Event Mesh is twofold: firstly, it persists
the incoming events, thereby maintaining a record of changes in the system&#8217;s
state. Secondly, it routes these events to their respective endpoints, ensuring
that the appropriate microservices are notified and can subsequently update
their internal states based on the event data.</p>
</div>
<div class="paragraph">
<p>The mesh&#8217;s inherent resilience is further bolstered by its exponential backoff
strategy, which it employs when encountering operational failures. This mechanism
ensures that the system retries the operation until it succeeds, thus mitigating
the risk of data loss or system disruption due to transient issues.</p>
</div>
<div class="paragraph">
<p>By integrating the Event Mesh into the system architecture, several architectural
benefits are achieved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Decomposition of the application into independently functioning services</strong>:
This approach facilitates a division of labor, with each service handling
specific responsibilities. This not only enhances maintainability but also
fosters scalability, as services can be independently scaled based on their
demands.</p>
</li>
<li>
<p><strong>Correction of systemic issues</strong>:
The Event Mesh&#8217;s error-handling mechanism, through retries and event
persistence, aids in minimizing the impact of failures on the end user.
This is crucial as it prevents bugs and outages from becoming visible to
the user, thereby preserving the system&#8217;s perceived responsiveness.</p>
</li>
<li>
<p><strong>Enhanced system performance</strong>:
The system becomes more responsive, as the end user no longer needs to
wait for multiple, often independent, operations to complete successfully.
The Event Mesh&#8217;s event-driven model, coupled with the retries and event
persistence, ensures that critical state changes are propagated swiftly and
reliably, thereby improving the overall user experience.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_event_mesh_flow"><a class="anchor" href="#_event_mesh_flow"></a><a class="link" href="#_event_mesh_flow">2.3. Event Mesh Flow</a></h3>
<div class="ulist">
<ul>
<li>
<p>Events are published as CloudEvents to a Knative&#8217;s Event Mesh.</p>
</li>
<li>
<p>Triggers route events dynamically to the appropriate endpoints.</p>
</li>
<li>
<p>Services process events, update state, and emit new events for downstream
consumers.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="https://www.plantuml.com/plantuml/svg/VP1DJiCm58JtFiMZ-rmWYwgqeHkeX2WNUBK7Ok4ubdyYzVQuZKbe5TZ5olTcFiqcHFOnTKOyn1OTIC8d0xPLdwBH5iBb_rfgnpRIwWMVBC_qwDoAED3ul4MUBKSzW9u6vES1eRsYMzz_mT-YZS-W3tJeLUwyOdlW23zeYJkK8vyuZ52p5O9bRk687uTYLgrB4zNqcav6XvPsR6GocTsZQ8d2L1aV3slQzVP3-uuKpCNgB1JkEwQpzI_FcjxoL5XgcUvdMioVL4soi-iuIOQcE5N259RYPgKYMNJ-3lfdkMPRqp7s7lJkjQFBvWihR61Lwimt" alt="VP1DJiCm58JtFiMZ rmWYwgqeHkeX2WNUBK7Ok4ubdyYzVQuZKbe5TZ5olTcFiqcHFOnTKOyn1OTIC8d0xPLdwBH5iBb rfgnpRIwWMVBC qwDoAED3ul4MUBKSzW9u6vES1eRsYMzz mT YZS W3tJeLUwyOdlW23zeYJkK8vyuZ52p5O9bRk687uTYLgrB4zNqcav6XvPsR6GocTsZQ8d2L1aV3slQzVP3 uuKpCNgB1JkEwQpzI FcjxoL5XgcUvdMioVL4soi iuIOQcE5N259RYPgKYMNJ 3lfdkMPRqp7s7lJkjQFBvWihR61Lwimt" width="100%">
</div>
</div>
<div class="paragraph">
<p>The diagram illustrates the flow of events between the legacy application, the Knative Event Mesh, the fee calculator service, and the datastore.</p>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_legacy_systems"><a class="anchor" href="#_supporting_legacy_systems"></a><a class="link" href="#_supporting_legacy_systems">2.4. Supporting Legacy Systems</a></h3>
<div class="paragraph">
<p>One of the strengths of an event mesh architecture is its ability to integrate seamlessly with legacy systems, making them more resilient and adaptable. Legacy applications can be retrofitted to produce and consume events through lightweight adapters. For instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A monolithic Java application can send events for specific operations, like CompleteTransit, instead of handling all logic internally.</p>
</li>
<li>
<p>Event listeners can be introduced incrementally, enabling the legacy app to subscribe to events like DriverFeeCalculated without refactoring its core logic.</p>
</li>
<li>
<p>This approach decouples old systems from rigid workflows, allowing for gradual modernization while ensuring operational continuity.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_improving_resilience_in_traditional_applications"><a class="anchor" href="#_improving_resilience_in_traditional_applications"></a><a class="link" href="#_improving_resilience_in_traditional_applications">2.5. Improving Resilience in Traditional Applications</a></h3>
<div class="paragraph">
<p>Traditional systems often rely on synchronous calls and transactions, which can cascade failures across components. Replacing these with asynchronous event-driven communication reduces dependencies.</p>
</div>
<div class="paragraph">
<p>For example, invoicing and notification services in an e-commerce platform can process OrderPlaced events independently, ensuring that downtime in one service does not block the entire order workflow.</p>
</div>
<div class="paragraph">
<p>Retry mechanisms provided by the event mesh guarantee that transient failures are handled gracefully without data loss.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="more_tech"><a class="anchor" href="#more_tech"></a><a class="link" href="#more_tech">3. More about the Technology Stack</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>It&#8217;s worth noting that <em>Knative&#8217;s Event Mesh</em> is completely transparent to the
applications. The applications publish and consume events, usually via
<em>HTTP REST</em>, and the only thing that is required is the <em>CloudEvents</em> format.</p>
</div>
<div class="paragraph">
<p>The <em>CloudEvents</em> format provides a common envelope for events with metadata
that every event needs, such as identifier, type, timestamps, or source
information. The format is a CNCF standard supported by a number of projects and
doesn&#8217;t enforce the use of any library.</p>
</div>
<div class="paragraph">
<p>This makes the investment in <em>Knative&#8217;s Event Mesh</em> safe in terms of vendor
lock-in. Architects can be assured that their options remain open and that
solutions can be easily reconfigured down the road.</p>
</div>
<div class="paragraph">
<p>What&#8217;s more, relying on well-known and easy-to-deploy <em>CloudEvents</em>, typically
over <em>HTTP</em>, makes testing simple and straightforward. Developers don&#8217;t need
complex development environments because the <em>Event Mesh</em> integration can be
easily tested with regular <em>REST</em> send or receive tests that most developers
are familiar with.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html" class="query-params-link">1. Home page</a></span>
  <span class="next"><a href="03-demo.html" class="query-params-link">3. See the Solution in Action</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <img
          src="../_/img/app-services-logo.png" height="40px" alt="Cloud Native Architecture Solution Patterns"  href="https://redhat.com" ></a>
</footer><script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
